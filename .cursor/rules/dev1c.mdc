---
alwaysApply: true
---

# Оркестрация работы через субагентов

Для выполнения задач разработки используй специализированных субагентов в следующем порядке:

## Рабочий процесс

1. **Архитектор** (`/architect`) - анализирует требования и определяет:
   - Какие метаданные и их связи необходимы для получения результата
   - Структуру решения и алгоритм реализации
   - Создает техническое задание для Программиста

2. **Программист** (`/programmer`) - реализует изменения по ТЗ от Архитектора:
   - Вносит код только в `CommonModules\СтруктураСебестоимости\Ext\Module.bsl`
   - Обновляет версию в `Configuration.xml` и в журнале регистрации
   - Передает код ДевОпсу для применения

3. **ДевОпс** (`/devops`) - применяет изменения и контролирует корректность:
   - Выполняет доставку изменений в тестовую базу
   - Проверяет журнал регистрации на ошибки применения
   - Передает управление Тестировщику при успехе

4. **Тестировщик** (`/tester`) - запускает проверки и тесты:
   - Запускает инструмент `prod_cost_ext` за период 01.01.2025 - 31.12.2025
   - Проверяет корректность результатов по сравнению с эталоном (`prod_cost`)
   - При ошибках возвращает ДевОпсу, при успехе передает Аналитику

5. **Аналитик** (`/analyst`) - анализирует результаты тестирования:
   - Выполняет глубокий анализ корректности работы и производительности
   - Проверяет соответствие реализации требованиям
   - Передает результаты анализа Архитектору для финального подтверждения

## Общие правила проекта

1. **Контекст разработки:**
   - Весь код вносится только в `CommonModules\СтруктураСебестоимости\Ext\Module.bsl` (слой изменения над СтруктураСебестоимости.bsl)
   - В папке ФСП эталонный отчет (не менять) - результат доступен в `prod_cost`
   - В папке Reports отчет который можно менять - результат доступен в `prod_cost_ext`

2. **Алгоритмы:**
   - Не пытаться вернуться к старому алгоритму - он работает, но медленный на больших объемах
   - Старый вариант: `ПараметрыДерева.Вставить("ИспользоватьПакетнуюОбработку", Ложь)`
   - Результат старого алгоритма **всегда считается правильным** - новый должен возвращать аналогичный результат

3. **Версионирование:**
   - Каждое изменение сопровождается изменением версии в `Configuration.xml` (секция Version)
   - Прибавлять по 1 в последнюю группу версии (0.1.0.9 → 0.1.0.10)
   - Версия вносится в первое сообщение журнала регистрации в `ikon_cost_ПараметрыДереваСебестоимости`

4. **Проверка применения:**
   - Команда доставки: `& 'C:\Program Files\1cv8\8.3.27.1936\bin\1cv8.exe' DESIGNER /S PGORODILOV.WSL/TEST_ERP_BRZ_01 /NAdmin /LoadConfigFromFiles E:\git\ikon_fact_cost -Extension ikon_cost_Доработки; Start-Sleep -Seconds 60; & 'C:\Program Files\1cv8\8.3.27.1936\bin\1cv8.exe' DESIGNER /S PGORODILOV.WSL/TEST_ERP_BRZ_01 /NAdmin /UpdateDBCfg -Extension ikon_cost_Доработки; Start-Sleep -Seconds 60; & 'C:\Program Files\1cv8\8.3.27.1936\bin\1cv8.exe' DESIGNER /S PGORODILOV.WSL/TEST_ERP_BRZ_01 /NAdmin /ReduceEventLogSize $((Get-Date).AddDays(1).ToString('yyyy-MM-dd')); Start-Sleep -Seconds 60`
   - Проверка журнала через `execution_log` с ограничением по текущему дню
   - Учитывать смещение времени в логах +2 часа
   - Не должно быть события `_$Session$_.ConfigExtensionApplyError` с комментарием 'Ошибка применения модуля ikon_cost_Доработки'

5. **Документация:**
   - Не создавать файлы описания и README.md если это прямо не запрашивается